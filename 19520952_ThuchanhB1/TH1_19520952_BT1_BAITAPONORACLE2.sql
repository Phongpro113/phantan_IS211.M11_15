ALTER SESSION SET NLS_DATE_FORMAT ='DD/MM/YYYY HH24:MI:SS';

CREATE TABLE BTKHDL2.USER_NEW
(
    U_ID NUMBER NOT NULL,
    USERNAME VARCHAR2(50),
    PASS VARCHAR2(20),
    REGDAY DATE,
    NATIONALITY VARCHAR2(30),
    CONSTRAINT PK_USER PRIMARY KEY(U_ID)    
);
CREATE TABLE BTKHDL2.CHANNEL
(
    CHANNELID VARCHAR2(4) NOT NULL,
    CNAME VARCHAR2(20),
    SUBSCRIBES NUMBER,
    OWNNER NUMBER REFERENCES BTKHDL2.USER_NEW(U_ID),
    CREATED DATE,
    CONSTRAINT PK_CHANNEL PRIMARY KEY(CHANNELID)
);
CREATE TABLE BTKHDL2.VIDEO 
(
    VIDEOID VARCHAR2(7) NOT NULL,
    TITTLE VARCHAR2(50),
    DURATION NUMBER,
    AGE NUMBER,
    CONSTRAINT PK_VIDEO PRIMARY KEY(VIDEOID)
)
CREATE TABLE BTKHDL2.SHARE_VIDEO
(
    VIDEOID VARCHAR2(7) REFERENCES BTKHDL2.VIDEO(VIDEOID),
    CHANNELID VARCHAR2(4)REFERENCES BTKHDL2.CHANNEL(CHANNELID),
    CONSTRAINT PK_SHARE PRIMARY KEY(VIDEOID)
)

ALTER USER BTKHDL2 quota unlimited on USERS;
INSERT INTO BTKHDL2.USER_NEW VALUES('001','FAPTV','123456abc','01/01/2014','Viet Nam');
INSERT INTO BTKHDL2.USER_NEW VALUES('002','KEMXOITV','@147869iii ','05/06/2015 ','Campuchia');
INSERT INTO BTKHDL2.USER_NEW VALUES('003','openshare ','qwertyuiop ','12/05/2009','Viet Nam');
SELECT * FROM BTKHDL2.USER_NEW;

INSERT INTO BTKHDL2.CHANNEL VALUES ('C102','FAP TV',2343,'001','02/01/2014');
INSERT INTO BTKHDL2.CHANNEL VALUES ('C905','Kem xoi TV',1032,'002','09/07/2015');
INSERT INTO BTKHDL2.CHANNEL VALUES ('C357','OpenShare Cafe',5064,'003','10/12/2010');

INSERT INTO BTKHDL2.VIDEO VALUES ('V100229','FAPtv Com Nguoi Tap 41 - Dot Nhap',469,18);
INSERT INTO BTKHDL2.VIDEO VALUES ('V211002','Kem xoi: Tap 31 - May Kool tinh yeu cua anh',312,16);
INSERT INTO BTKHDL2.VIDEO VALUES ('V400002','Noi t?nh yêu ket thúc - Hoàng Tuan',378,0);

INSERT INTO BTKHDL2.SHARE_VIDEO VALUES('V100229','C905');
INSERT INTO BTKHDL2.SHARE_VIDEO VALUES('V211002','C102');
INSERT INTO BTKHDL2.SHARE_VIDEO VALUES('V400002','C357');

/*Cau 5*/

SELECT *
FROM BTKHDL2.VIDEO 
WHERE AGE >= 16;

/*Cau 6*/
SELECT *
FROM BTKHDL2.CHANNEL
WHERE SUBSCRIBES >= ALL (SELECT SUBSCRIBES FROM BTKHDL2.CHANNEL);

/*Cau 7*/
SELECT BTKHDL2.VIDEO.VIDEOID, COUNT(CHANNELID) AS "SO KENH CHIA SE"
FROM BTKHDL2.VIDEO, BTKHDL2.SHARE_VIDEO
WHERE AGE = 18
AND BTKHDL2.VIDEO.VIDEOID = BTKHDL2.SHARE_VIDEO.VIDEOID
GROUP BY BTKHDL2.VIDEO.VIDEOID;

/*Cau 8*/
SELECT *
FROM BTKHDL2.VIDEO
WHERE NOT EXISTS (SELECT *
                FROM BTKHDL2.CHANNEL
                WHERE NOT EXISTS (SELECT *
                                    FROM BTKHDL2.SHARE_VIDEO
                                    WHERE BTKHDL2.VIDEO.VIDEOID = BTKHDL2.SHARE_VIDEO.VIDEOID
                                    AND BTKHDL2.CHANNEL.CHANNELID = BTKHDL2.SHARE_VIDEO.CHANNELID))